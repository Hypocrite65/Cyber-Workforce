# æ—¥å¿—ç³»ç»Ÿå’Œæˆæœ¬ç›‘æ§

## ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬**: v1.0
- **ä½œè€…**: wei-Aug2024
- **æ—¥æœŸ**: 2026-01-29
- **æ€»ç»“**: é˜¶æ®µ1å®æ–½ - è¿è¡Œæ—¶æ—¥å¿—ã€Tokenè¿½è¸ªå’Œé¢„ç®—æ§åˆ¶

---

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

### 1. è¿è¡Œæ—¶æ—¥å¿—ç³»ç»Ÿ
- âœ… è‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³æ—¥å¿—æ–‡ä»¶: `logs/run_YYYYMMDD_HHMMSS_é¡¹ç›®å.log`
- âœ… åŒè¾“å‡ºæ¨¡å¼: æ§åˆ¶å°(ç®€æ´) + æ–‡ä»¶(è¯¦ç»†)
- âœ… åˆ†çº§æ—¥å¿—: DEBUG, INFO, WARNING, ERROR
- âœ… Agent æ¶ˆæ¯å®Œæ•´è®°å½•

### 2. Token ä½¿ç”¨è¿½è¸ª
- âœ… å®æ—¶ç»Ÿè®¡æ¯ä¸ªæ¨¡å‹çš„ token æ¶ˆè€—
- âœ… è‡ªåŠ¨æˆæœ¬è®¡ç®—(åŸºäºé…ç½®ä»·æ ¼è¡¨)
- âœ… ç”Ÿæˆè¯¦ç»†ä½¿ç”¨æŠ¥å‘Š: `logs/token_usage_YYYYMMDD_HHMMSS_é¡¹ç›®å.json`
- âœ… æ§åˆ¶å°æ‘˜è¦è¾“å‡º

### 3. é¢„ç®—æ§åˆ¶
- âœ… å¯é…ç½®çš„æˆæœ¬ä¸Šé™
- âœ… æœ€å¤§è½®æ¬¡é™åˆ¶
- âœ… é¢„ç®—è­¦å‘Šé˜ˆå€¼
- âœ… è¶…é™è‡ªåŠ¨æé†’(å¯é€‰å¼ºåˆ¶ç»ˆæ­¢)

### 4. æœ¬åœ°æ¨¡å‹æ¥å£é¢„ç•™
- âœ… é…ç½®æ–‡ä»¶æ”¯æŒ `provider` å­—æ®µ
- âœ… é›¶æˆæœ¬æ¨¡å‹æ”¯æŒ(Ollama, æœ¬åœ°æ¨¡å‹)
- âœ… ç¤ºä¾‹é…ç½®æ–‡ä»¶æä¾›

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### é…ç½®é¢„ç®—æ§åˆ¶

ç¼–è¾‘ `secrets/config.json`:

```json
{
  "budget_control": {
    "enabled": true,           // å¯ç”¨é¢„ç®—æ§åˆ¶
    "max_cost_cny": 10.0,      // æœ€å¤§æˆæœ¬ 10 å…ƒ
    "max_rounds": 30,          // æœ€å¤§ 30 è½®å¯¹è¯
    "warning_threshold": 0.8   // å‰©ä½™ 20% æ—¶è­¦å‘Š
  }
}
```

### æŸ¥çœ‹æ—¥å¿—

è¿è¡Œåè‡ªåŠ¨ç”Ÿæˆ:
```
logs/
â”œâ”€â”€ run_20260129_165749_my_project.log          # è¿è¡Œæ—¥å¿—
â””â”€â”€ token_usage_20260129_165749_my_project.json # Token ä½¿ç”¨æŠ¥å‘Š
```

### Token ä½¿ç”¨æŠ¥å‘Šç¤ºä¾‹

```json
{
  "project": "my_project",
  "duration_seconds": 125.43,
  "total_rounds": 12,
  "total_cost_cny": 0.1234,
  "budget_limit_cny": 10.0,
  "models": {
    "qwen-max": {
      "calls": 8,
      "input_tokens": 15234,
      "output_tokens": 8921,
      "total_tokens": 24155,
      "cost_cny": 0.0987
    }
  }
}
```

---

## ğŸ”§ é…ç½®æœ¬åœ°æ¨¡å‹(é¢„ç•™)

è™½ç„¶é˜¶æ®µ1æš‚ä¸å®æ–½,ä½†å·²é¢„ç•™æ¥å£ã€‚æœªæ¥å¯è¿™æ ·é…ç½®:

```json
{
  "models": {
    "local_llama": {
      "provider": "ollama",
      "model": "llama3:8b",
      "api_key": "not-needed",
      "base_url": "http://localhost:11434/v1"
    }
  }
}
```

å‚è€ƒ `secrets/config.example.json` æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹ã€‚

---

## ğŸ“Š æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹

```
ğŸ”§ Initialized workspace at: e:\Cyber-Workforce\output\my_project\workspace
ğŸ¢ Loading Company Config: companies/web_team.json
ğŸ“ Log file: logs\run_20260129_165749_my_project.log
  ğŸ‘¤ Hire: WebArchitect (Model: qwen-max)
  ğŸ‘¤ Hire: CodeReviewer (Model: qwen-turbo)
ğŸš€ Company Started Working...
...
âœ… Work Session Finished.

============================================================
ğŸ“Š Token ä½¿ç”¨æŠ¥å‘Š - my_project
============================================================
â±ï¸  è¿è¡Œæ—¶é•¿: 125.43s
ğŸ”„ æ€»è½®æ¬¡: 12
ğŸ’° æ€»æˆæœ¬: Â¥0.1234
ğŸ“ˆ é¢„ç®—é™åˆ¶: Â¥10.0000
ğŸ’µ å‰©ä½™é¢„ç®—: Â¥9.8766

æ¨¡å‹è¯¦æƒ…:
  ğŸ¤– qwen-max:
     è°ƒç”¨æ¬¡æ•°: 8
     è¾“å…¥ Tokens: 15,234
     è¾“å‡º Tokens: 8,921
     æˆæœ¬: Â¥0.0987
  ğŸ¤– qwen-turbo:
     è°ƒç”¨æ¬¡æ•°: 4
     è¾“å…¥ Tokens: 5,123
     è¾“å‡º Tokens: 2,456
     æˆæœ¬: Â¥0.0247
============================================================

ğŸ“Š Token usage report saved: logs\token_usage_20260129_165749_my_project.json
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### é˜¶æ®µ2 (çŸ­æœŸ)
- [ ] é›†æˆ LiteLLM ç»Ÿä¸€æ¥å£
- [ ] å®ç° Ollama æœ¬åœ°æ¨¡å‹æ”¯æŒ
- [ ] ä¼˜åŒ–é…ç½®æ–‡ä»¶ç»“æ„

### é˜¶æ®µ3 (ä¸­æœŸ)
- [ ] å¼€å‘ Streamlit/Gradio UI
- [ ] æ—¶é—´æˆ³è¾“å‡ºå­æ–‡ä»¶å¤¹
- [ ] ä»»åŠ¡éªŒè¯å’Œæ¾„æ¸…æ­¥éª¤

---

## ğŸ“š å‚è€ƒèµ„æº

- [AutoGen å®˜æ–¹ç¤ºä¾‹](https://github.com/ag2ai/build-with-ag2)
- [LangGraph å¯è§‚æµ‹æ€§](https://langchain-ai.github.io/langgraph/)
- [Smolagents + Ollama](https://github.com/huggingface/smolagents)

---

## ğŸ› æ•…éšœæ’æŸ¥

### æ—¥å¿—æ–‡ä»¶æœªç”Ÿæˆ
- æ£€æŸ¥ `logs/` ç›®å½•æƒé™
- ç¡®è®¤é¡¹ç›®åç§°æ­£ç¡®æå–

### Token ç»Ÿè®¡ä¸º 0
- AutoGen å¯èƒ½æœªè¿”å› usage ä¿¡æ¯
- æŸäº›æ¨¡å‹ä¸æ”¯æŒ token ç»Ÿè®¡
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ä¸­çš„ DEBUG ä¿¡æ¯

### é¢„ç®—æ§åˆ¶ä¸ç”Ÿæ•ˆ
- ç¡®è®¤ `config.json` ä¸­ `enabled: true`
- æ£€æŸ¥é…ç½®æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®

---

**å¦‚æœ‰é—®é¢˜,è¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–è”ç³»å¼€å‘è€…ã€‚**
